<!DOCTYPE html>

<html>
  <head>
    <title>Wedding Invitation Card</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="styles.css">
    
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="gesture-detector.js"></script>
    <script src="gesture-handler.js"></script>
     <script>
        AFRAME.registerComponent('event-listener', {
            init: function () {
                this.audio = document.querySelector("#song");

                this.el.addEventListener('click', function (e) {
		
                    let cake = document.querySelector('#cake-model')
		    cake.setAttribute('animation-mixer', "clip: BeanCake|360_NoScop_Rat; loop: once;");
                    this.audio.play();
			
                  console.log(e)
                }.bind(this));
		
                this.el.addEventListener('mouseenter', function (e) {
                    console.log(e)
                }.bind(this));
		    
		 this.el.addEventListener('mouseleave', function (e) {
			 console.log(e)
                }.bind(this));
		 
		
                this.el.addEventListener('touchmove', function (e) {
                    //this.audio.play();
			
                  console.log(e)
                }.bind(this));
                this.el.addEventListener('touchstart', function (e) {
		
                    let cake = document.querySelector('#cake-model')
		    cake.setAttribute('animation-mixer', "clip: BeanCake|360_NoScop_Rat; loop: once;");
                    this.audio.play();
			console.log(e)
                }.bind(this));
		    
		 this.el.addEventListener('touchend', function (e) {
			 console.log(e)
                }.bind(this));
		    
		
                this.el.addEventListener('animation-finished', function (e) {
			 console.log(e)
                    let cake = document.querySelector('#cake-model')
		    cake.removeAttribute('animation-mixer');
                }.bind(this));
		
            }
        });
</script>
  </head>

  <body>
    <a-scene
      arjs="trackingMethod: best; sourceType: webcam;debugUIEnabled: false;"
      embedded
      renderer="logarithmicDepthBuffer: true;"
      renderer="colorManagement: true">
      vr-mode-ui="enabled: false"
      gesture-detector
      id="scene"
    >
      <a-assets>
        <a-asset-item
          id="couple"
          src="https://johnbenedictcastillo.github.io/bscsA/cruz-malabanan/couple1.glb"
        >
        </a-asset-item>
      </a-assets>
      
      <a-marker
        type="pattern"
        url="https://johnbenedictcastillo.github.io/bscsA/cruz-malabanan/marker/pattern-couple.patt"
      >
        <a-box
          position="0.5 0 -0.5"
          scale="0.5 0.5 0.5"
          radius="1.25"
          rotation="10 43 45"
          color="#e3c099"
        >
        </a-box>

        <a-entity
          id="couple-model"
          gltf-model="#couple"
          position="0 0 0"
          scale="0.005 0.005 0.005"
          rotation="0 0 0"
          class="clickable"
          gesture-handler
        >
        </a-entity>
        
        <a-assets>
        <a-asset-item id="cake" response-type="arraybuffer" src="./stylizedcakes.glb"></a-asset-item>
        <audio id="song" src="./assets/Drum.wav"></audio>
        </a-assets>
        
        <a-entity event-listener id="cake-model"  
          gltf-model="#cake" 
          scale="1 1 1" 
          position = "0 0 0.5" 
          rotation="0 0 0" 
        >
          
        </a-entity>
        <a-sound src="#song" autoplay="false"></a-sound>
        <a-entity cursor="rayOrigin:mouse"></a-entity>
        <a-entity cursor="fuse: true; fuseTimeout: 500"></a-entity>
      </a-marker>
      
      <a-entity camera></a-entity>
    </a-scene>
  </body>
</html>
